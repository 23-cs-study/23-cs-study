## 데이터베이스 샤딩이란?

대규모 데이터베이스를 여러 머신에 저장하는 프로세스

데이터를 샤드라고 하는 더 작은 청크로 분할하고 여러 데이터베이스 서버에 저장함으로써 이러한 한계를 극복한다
모든 데이터베이스 서버의 기본 기술은 일반적으로 동일하며 함께 작동하여 대량의 데이터를 저장하고 처리한다
* application level에서도 가능하지만 database level에서도 가능하다
  (VS Vertical Partitioning : 도메인에 영향을 많이 받기 때문에 대부분 application level에서 CRUD를 구현함)
* Horizontal Partitioning이라고 볼 수 있다

![Sharding1.png](Sharding1.png)


</br>
[사용 배경]
애플리케이션이 성장함에 따라 애플리케이션 사용자 수와 애플리케이션에 저장되는 데이터의 양도 시간이 갈수록 증가한다
데이터 볼륨이 너무 커지고 애플리케이션을 사용하여 동시에 정보를 읽거나 저장하려고 하는 사용자가 너무 많아지면 데이터베이스에서 병목 현상이 발생한다
이로 인해 애플리케이션 속도가 느려지는데 이에 대한 솔루션으로, 여러 샤드에서 더 작은 데이터 세트를 병렬로 처리하는 데이터베이스 샤딩을 사용하면 이 문제를 해결할 수 있다

[필요한 원리]
1. 분산된 Database에서 Data를 어떻게 Read할 것인가?
2. 분산된 Database에 Data를 어떻게 잘 분산시켜서 저장할 것인가?
    분산이 잘 되지 않고, 한쪽으로 Data가 몰리게 되면 자연스럽게 Hotspot이 되어 성능이 느려지게 됨
    그렇기 때문에 균일하게 분산하는 것이 중요한 목표

[샤딩의 이점]

응답 시간 개선
 - 데이터 샤드는 전체 데이터베이스보다 행 수가 적어서, 샤딩된 데이터베이스에서는 특정 정보를 검색하거나 쿼리를 실행하는 데 걸리는 시간이 단축됨
 
전체 서비스 중단 방지
 - 데이터베이스 샤딩은 데이터베이스 일부를 다른 컴퓨터에 배포함으로써 이 같은 문젤르 방지함
    샤딩은 샤드 간 데이터 복제와 함께 사용되는 경우가 많은데, 샤드 중 하나를 사용할 수 없게 되더라도 대체 샤드에서 데이터에 액세스하고 복원할 수 있음

효율적인 크기 조정
 - 데이터베이스 샤딩을 사용하여 더 많은 컴퓨팅 리소스를 추가함으로써 데이터베이스의 확장을 지원할 수 있다
 - 데이터 베이스 확장으로 더 많은 컴퓨팅 리소스를 소비하고 스토리지의 최대 용량에 도달하게 됨
 - 유지 관리를 위해 애플리케이션을 종료하지 않고도 런타임에 새 샤드를 추가 할 수 있다 


[샤딩] Sharding을 적용한다는 것은?</br>

  1.  프로그래밍, 운영적인 복잡도는 더 높아지는 단점이 있다</br>
  2.  가능하면 Sharding을 피하거나 지연시킬 수 있는 방법을 찾는 것이 우선되어야 한다</br>
  * Scale-in</br>
    Hardware Spec이 더 좋은 컴퓨터를 사용한다
    
  * Read부하가 크다면?</br>
    Cache나 Database의 Replication을 적용하는 것도 하나의 방법
    
  * Table의 일부 컬럼만 자주 사용한다면?</br>
    Vertically Partition도 하나의 방법
    Data를 Hot, Warm, Cold Data로 분리하는 것
    
    
[샤딩방법]
    1. Hash Sharding
        Shard Key를 어떻게 정의하느냐에 따라 데이터를 효율적으로 분산시키는 것이 결정된다
        Shard Key : Database id를 Hashing하여 결정한다
    2. Dynamic Sharding
    

Reference
[블로그 레퍼런스1](https://aws.amazon.com/ko/what-is/database-sharding/)
[블로그 레퍼런스2](https://nesoy.github.io/articles/2018-05/Database-Shard)
