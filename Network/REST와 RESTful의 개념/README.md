# REST와 RESTful의 개념

잘 설계되어 있는 현대의 네트워크 시스템 덕분에 우리는 다양한 도구를 사용해서 협업을 할 수 있게 되었습니다. 그 중에서도 우리가 너무나도 자주 쓰고 있지만 제대로 알고 있다고 말하기는 어려운 개념 중 하나가 바로 REST라고 생각합니다.  
> REST API를 기반으로 서버와 클라이언트가 통신할 수 있게 설계를 어쩌구저쩌구...  

습관처럼 이야기 하지만 정작 나의 통신 방식이 정말 'REST'한지는 고민해본 적은 저 또한 없기에 이번 글을 기회로 제대로 정리해보려 합니다. 

## REST가 왜 필요해? 
지금은 너무 당연해져서 질문할 필요도 없어졌지만 REST가 없었던 시절에는 SOAP라는 조금은 생소한 방식을 주로 사용했다고 합니다. 그리고 이것은 REST에 비해 복잡했기 때문에 많은 사람들이 불편함을 호소했죠. 이 형식을 사용하지 않더라도 서버와 클라이언트가 서로 통신하는 방식이 제각기 다르던 시절도 있었기에 이 시절에는 팀을 옮길 때마다 통신 방식이 바뀌는 끔찍한 경우도 있었겠죠.  
따라서 이전의 구린 방식을 대체하고 표준을 정하기 위해 REST의 개념을 도입하게 되었고 덕분에 우리는 모두가 RESTful한 API를 설계하고(뒤에서 설명하겠지만 정확하게는 추구한다고 하는게 맞습니다) 통일성이 부여된 통신을 할 수 있게 되었습니다. 

## 그래서 REST가 뭔데?
이때 먼저 정확하게 집고 넘어가야 하는 점은 REST는 어떤 상품이 아니라 하나의 형식이라는 것입니다. 어떤 클라이언트, 서버 프레임워크를 사용하던 REST한 조건을 맞춘다면 "REST하다", "REST API의 조건을 맞추고 있다"라고 말할 수 있다는 것이죠. 이걸 좀 멋있게 보이는 말로 __월드 와이드 웹과 같은 분산 하이퍼미디어 시스템을 위한 소프트웨어 아키텍처의 한 형식__ 이라고 설명합니다.

REST의 정확한 의미는 다음과 같습니다. 
> __Representational State Transfer__  

사랑스런 우리말로 풀어보면 표현(representation)에 의해 상태(status)를 전달(transfer)한다는 뜻이죠. 조금은 불분명하죠? 하나씩 살펴봅시다. 

### STATUS
먼저 __상태의 의미__ 부터 봅시다. 여기서 말하는 상태란 우리가 소프트웨어로 관리하는 모든 __자원(Resource)의 요청되어지는 시점의 상태__ 를 말합니다. 예를들어 요청하는 것이 문서든 코드든 혹은 DB의 데이터든 상관없이 언제든 변할 가능성이 있고 원하는 자원을 요청했을 때는 특정 시점의 상태가 존재할 것이니 특별히 status라고 부른다고 보시면 됩니다. 

### REPRESENTATION
표현은 어떠한 자원을 보낼 때 사용할 특정 형태를 말합니다. REST에서 하나의 자원은 JSON , XML , TEXT , RSS 등 여러형태의 Representation으로 나타낼수 있습니다. 요즘은 거의 JSON을 많이 쓰고 있는 추세입니다.

### 결국 그래서 REST가 뭔데? 
한줄로 말하자면 다음과 같습니다. 
> HTTP URI(Uniform Resource Identifier)를 통해 자원(Resource)을 명시하고, HTTP Method(POST, GET, PUT, DELETE)를 통해 해당 자원에 대한 CRUD Operation을 적용하는 것을 의미.  

결국 REST는 자원을 어떻게 처리할 것인가를 고민하는 것이 핵심이고 그것을 HTTP Method를 통해 설계된 하나의 아키텍쳐인 것 입니다.  
-> 자원 기반의 구조(ROA, Resource Oriented Architecture) 설계
HTTP의 핵심인 URI는 자원을 쉽게 구분하고 지정할 수 있게 만들고 덕분에 우리는 쉽게 자원들을 생성하고 조회하며 수정하고 삭제 할 수 있는 것이죠. 
-> CRUD Operation

## REST는 무조건 좋아?
세상의 모든 것이 그러하듯 당연히 그렇진 않겠죠?  
REST는 아까도 말했듯 상품이 아니라 HTTP 프로토콜을 사용한 형식입니다. 그래서 REST를 위한 별도의 인프라를 구축할 필요가 없었습니다. 그냥 __형식을 맞추기만 하면 어떤 서버, 클라이언트든지 상관없이 모든 플랫폼에서 사용가능__ 하다는 이야기죠.  
또 __REST가 지향하는 것이 '명확한 의도'__ 이므로 우리는 여러 서비스에서 겪을 수 있는 다양한 문제를 어느정도 줄이고 시작할 수 있고 서버와 클라이언트에서 서로 쉽게 의도를 파악할 수도 있으며 덕분에 서버와 클라이언트는 서로의 역할을 더욱 명확하게 분리할 수도 있습니다. 

그럼에도 불구하고 __아주 명확한 표준은 없다는 것__ (API 호출에서 url은 언제나 똑같은 형태는 아니니까요), __HTTP의 모든 메서드를 다 사용할 수는 없다는 것__ (정확하게는 RESTful하다고 부를 수 없다는 의미)과 같은 단점도 존재하기는 합니다. 

아래의 특징을 살펴보면 아마 이해가 더 빠르실 겁니다.

## 특징은 뭐야? 
아래의 특징들은 REST는 이런 특징이 있어라는 의미보다 아래의 조건들을 만족해야 REST하다고 말할 수 있어라고 받아들이는 것이 더 적절하다고 생각합니다.
1. Server-Client (서버-클라이언트 구조)  
    자원이 있는 쪽이 Server, 자원을 요청하는 쪽이 Client가 됩니다. REST Server는 API를 제공하며 비즈니스 로직 처리 및 저장을 책임지고, Client는 사용자 인증이나 context(세션, 로그인 정보) 등을 직접 관리하고 책임지는 것으로 역할을 분명하게 구분하는 것이죠. 이로써 서로 간의 의존성을 줄일 수 있습니다.

2. Stateless (무상태)  
    HTTP 프로토콜은 Stateless Protocol이므로 REST 역시 무상태성을 갖습니다. Client의 context(세션과 쿠키와 같은 것)를 Server에 저장하지 않기에 사용자 정보는 신경쓰지 않아도 되므로 Server의 구현이 보다 단순해집니다. 덕분에 각각의 요청을 완전히 별개의 것으로 인식하고 처리할 수도 있구요.
    이러한 요청이 다음 요청의 처리에 연관되어서는 안된다는 원칙 덕에(DB에 의해 바뀌는 것은 허용) Server의 처리 방식에 일관성을 부여할 수 있고 서비스의 자유도 또한 높아집니다.
3. Cacheable (캐시 처리 기능)  
    웹 표준 HTTP 프로토콜을 그대로 사용하므로 웹에서 사용하는 기존의 인프라를 그대로 활용할 수 있습니다. 즉, HTTP가 가진 가장 강력한 특징 중 하나인 캐싱 기능을 적용할 수 있습니다. HTTP 프로토콜 표준에서 사용하는 Last-Modified Tag 또는 E-Tag를 이용해 캐싱을 구현합니다. 덕분에 대량의 요청에 매번 응답하지 않아도 되므로 효율적인 처리가 가능합니다.  
4. Layered System (계층 구조)  
    Client는 REST API Server만 호출할 수 있는 반면 REST Server는 다중 계층으로 구성될 수 있습니다. 보안, 로드 밸런싱, 암호화 등을 위한 계층을 추가하여 구조를 변경할 수 있는 자유가 있죠. Proxy, Gateway와 같은 네트워크 기반의 중간매체를 사용할 수도 있지만 Client는 Server와 직접 통신하는지, 중간 서버와 통신하는지는 알 수 없습니다. Client는 신경쓰지 않고 그냥 요청을 보낼 수 있도록 말이죠.
5. Uniform Interface (인터페이스 일관성)  
    HTTP 표준 프로토콜에 따르는 모든 플랫폼에서 사용이 가능하다는 의미입니다. 즉, 특정 언어나 기술에 종속되지 않기에 클라이언트가 브라우저든지 모바일 어플이든지 상관없이 사용이 가능합니다. 
6. Self-Descriptiveness (자체 표현)  
    요청 메시지만 보고도 쉽게 이해할 수 있는 자체 표현 구조로 되어있습니다. GET, POST, PUT, DELETE는 단어 그 자체 의미로도 우리는 쉽게 요청의 의도를 알 수 있으니까요.

## 그럼 REST API는 뭐야

기업에서 개발한 open API를 포함해서 많은 프로젝트에서 REST한 API로 설계를 하다보니 최근에는 API라고 한다면 거의 RESTful한 API를 의미하곤 하지만 정말 RESTful한 API인지는 생각해봐야하는 지점이죠. 그리고 RESTful이 무엇인지 알아야 그것이 가능할 것 이구요.

RESTful은 말 그대로 “REST하다” 더 자세히는 “REST의 원칙을 준수한다"라는 의미라고 할 수 있습니다. 즉, **REST API 혹은 RESTful API는 REST가 지켜야할 규칙, 제약조건을 만족하는 아키텍처로 구성된 Application Programming Interface 라는 뜻**인 것이죠.

REST API의 가장 큰 특징은 각 요청이 어떤 동작이나 정보를 위한 것인지를 그 요청의 모습 자체로 추론이 가능한 것 입니다.

REST API 설계 시 여러 원칙들이 있지만 가장 중요한 항목은 다음의 2가지입니다.

- 첫 번째, URI는 정보의 자원을 표현해야 한다.
- 두 번째, 자원에 대한 행위는 HTTP Method(GET, POST, PUT, PATCH, DELETE)로 표현한다 (행위(Method)는 URI에는 포함하지 않는다)

이 두가지 항목이 REST API의 가장 큰 특징인 **형태 그 자체로 API의 의미를 알 수 있다**는 장점을 잘 살릴 수 있습니다.

### REST API의 설계 규칙

1. URI는 명사를 사용한다.(리소스명은 동사가 아닌 명사를 사용해야 한다.)
1-1. 아래와 같은 동사를 사용하지 말 것
/getAllUsers/getUserById/createNewUser/updateUser/deleteUser2. 슬래시( / )로 계층 관계를 표현한다.
 
3. URI 마지막 문자로 슬래시 ( / )를 포함하지 않는다.
 
4. 밑줄( _ )을 사용하지 않고, 하이픈( - )을 사용한다.
 
5. URI는 소문자로만 구성한다.
 
6. HTTP 응답 상태 코드 사용
    - 클라이언트는 해당 요청에 대한 실패, 처리완료 또는 잘못된 요청 등에 대한 피드백을 받아야 한다.
 
7. 파일확장자는 URI에 포함하지 않는다.

## 정리

REST한 API, 그리고 REST를 만족하는 시스템 아키텍쳐는 분명 많은 장점이 있고 따라서 최근 API 설계들의 가장 보편적인 원칙이 되었습니다. 그러나 알아야 분명히 할 것은 REST는 만능이 아니라는 것입니다. 나름 까다로운 여러 규약을 가지고 있기에 가끔은 설계에 방해가 되기도 하죠.(엄격하게는 PATCH도 허용하지 않는 것을 요구하기도 하니까요) 따라서 최근에는 REST를 대체하기 위한 API 쿼리 언어인 GraphQL이 세상에 등장하기도 하였습니다. 항상 그렇듯 무조건이라는 원칙은 없으니 개발자들은 상황에 따라 유연한 대처가 필수라는 것을 함께 기억하면 좋겠네요

오늘도 긴 글 읽어주셔서 감사합니다!


## Reference 
* https://hckcksrl.medium.com/rest%EB%9E%80-c602c3324196
* https://youtu.be/iOueE9AXDQQ
* https://dev-coco.tistory.com/97
* https://gmlwjd9405.github.io/2018/09/21/rest-and-restful.html